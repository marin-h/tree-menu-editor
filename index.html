<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
  <!-- index.css -->
  <link rel="stylesheet" href="/tree-menu-editor/index.css">
  <title>Mate Bot - Editor</title>
  <script src="https://unpkg.com/vue@2.6.14"></script>
  <link rel="apple-touch-icon" sizes="180x180" href="/tree-menu-editor/assets/apple-touch-icon.a8ff5bd6.png">
  <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,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">
  <link rel="icon" type="image/png" sizes="16x16" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAApRJREFUOE+VkltIFFEYx/9nd2ZnRl13183V9VJUBGYklim6EhEpVvZSUg8F0kMvJSgoBUmFdFG6WGhZL0FhlwfDesnKLCrEDMsMgxKiorys7qbuurfZnZmd8Iimsg95nr7znf/348//OwSLjtpbvDYcUiqVyT9b1WBo+fQz4XS/taZlrzQ67WWS1fZ1/giZvcQfaYoxyMyFbSvGDmp8k4IaEhegiY5HONoUePkr4babkY85r5d5KXxWtaW+57jX5axd7CjSPcYYX/2mKqduDrC3xZEJDdP3P8NzmrC84cE+yyfivZWeOKTfOHgSjQyrAQpXcYhiCV78DMIlqlRv5AkKVnLwSyo6fgQhhYEzKJdTPB9Tifda3PPhxJ2FJ9CIw1lRyHjUDNnuQLCyAke7JAq4aGPBXWkAY7Wgf3cpbvT6cRblSB590kF8V42hIesudhrQkK9FoKiEDiU21aLCtYbWDcZvGC2rprXQ3oqKLoUCUuyPJeJvMt0dTCg+MA0ozRCw+f1T6sC5vxSn3s5s4rSNQ/z9O9RBZ/YONPcHKCB1rO0eUVvWxX0hOZ9rSH0SIUBOEksz6B6SIMozGfAMQV4KSzPoGZGgqkCNWjWSrvasp2vc0zqeq1VJ91K2oBA172GJ+d0CwKa4IIrSjBifdEMfE4VgaCZETsfC4/XDbDKgfcCFDxMcIgIOrZ5CfpoVw45xmA16+MUg/WsCr8OE24NkixldA3bc/B4bGWDhFWRaefgCIngdC1lRqANGq4UYkhAt8Oizi3CK2n8AW93rbIblz7G8UDg/AyE6FoLeQFsBjxsB39SCiCQx0KEocjWxne+8RFRURQrQaEmmbZdjOGK+KkE9ya3rLNBosH0pG5jVhsN49heK/Q2Vk9oLVgAAAABJRU5ErkJggg==">
  <link rel="manifest" href="data:application/manifest+json;base64,eyJuYW1lIjoiIiwic2hvcnRfbmFtZSI6IiIsImljb25zIjpbeyJzcmMiOiIvYW5kcm9pZC1jaHJvbWUtMTkyeDE5Mi5wbmciLCJzaXplcyI6IjE5MngxOTIiLCJ0eXBlIjoiaW1hZ2UvcG5nIn0seyJzcmMiOiIvYW5kcm9pZC1jaHJvbWUtNTEyeDUxMi5wbmciLCJzaXplcyI6IjUxMng1MTIiLCJ0eXBlIjoiaW1hZ2UvcG5nIn1dLCJ0aGVtZV9jb2xvciI6IiNmZmZmZmYiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiI2ZmZmZmZiIsImRpc3BsYXkiOiJzdGFuZGFsb25lIn0=">
  <script type="module" crossorigin src="/tree-menu-editor/assets/index.c6bb3c16.js"></script>
    <link rel="modulepreload" href="/tree-menu-editor/assets/vendor.003fa364.js">
    <link rel="stylesheet" href="/tree-menu-editor/assets/index.06d14ce2.css">
  </head>

<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <span class="navbar-brand" href="#">Mate Bot<span class="d-none d-md-inline"> > </span><br
          class="d-md-none" />Editor de configuración</span>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="about.html">Guía de uso</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container px-5">
    <script type="text/x-template" id="item-template">
        <li>
          <div :class="{bold: isFolder}">
            <input placeholder="Escriba el nombre de este menu" type="text" v-model="item.name" v-bind:readonly="isRoot">
            <span @click="toggle" @dblclick="makeFolder" v-model="item">[{{ isOpen ? '-' : '+' }}]</span>
            <span @click="removeItem" v-model="item">{{ isRoot ? '' : '🗑'}}</span>
            <br>
            <textarea v-model="item.text" placeholder="Escriba el texto de la respuesta"></textarea>
          </div>
          <ul v-show="isOpen" v-if="isFolder">
            <tree-item
              class="item"
              v-for="(child, index) in item.children"
              :key="index"
              :item="child"
              @make-folder="$emit('make-folder', $event)"
              @add-item="$emit('add-item', $event)"
              @remove-child="removeChild"
              @delete="$emit('remove-child', $event, item.children)"
            ></tree-item>
            <li class="add" @click="$emit('add-item', item)">+</li>
          </ul>

          <label class="btn btn-custom btn-secondary" v-show="isRoot && !item.children" for="file-selector">Cargar</label>
          <input type="file" id="file-selector" accept=".json" @change="loadData">
          <label class="btn btn-custom btn-primary" v-show="isRoot && item.children" v-on:click="$emit('get-data', item)">Descargar</label>
        </li>
      </script>
    <h1>¡Bienvenido/a!</h1>

    <p style="line-height:2rem">
      Para agregar opciones anidadas: doble click en el "[+]"
      <br>Para colapsar o desplegar opciones: click en el "[-]" o "[+]"
      <br>Para cargar un archivo de configuración inicial: click en el botón "Cargar"
      <br>Para descargar un archivo con la configuración nueva: click en el botón "Descargar"
    </p>

    <!-- the demo root element -->
    <ul id="demo">
      <tree-item class="item" :item="treeData" @make-folder="makeFolder" @add-item="addItem" @remove-child="removeChild"
        @get-data="getData" @set-data="setData">
      </tree-item>
    </ul>

    <script>
      // define the tree-item component
      Vue.component("tree-item", {
        template: "#item-template",
        props: {
          item: Object,
        },
        data: function () {
          return {
            isOpen: false,
          };
        },
        computed: {
          isFolder: function () {
            return this.item.children && this.item.children.length;
          },
          isRoot: function () {
            return this.item.name === 'start'
          }
        },
        methods: {
          toggle: function () {
            if (this.isFolder) {
              this.isOpen = !this.isOpen;
            }
          },
          makeFolder: function () {
            if (!this.isFolder) {
              this.$emit("make-folder", this.item);
              this.isOpen = true;
            }
          },
          removeItem: function () {
            console.log('removeItem', JSON.stringify(this.item))
            this.$emit("delete", this.item);
          },
          removeChild: function (item, children) {
            children.splice(children.indexOf(item), 1);
          },
          loadData: function (event) {
            const reader = new FileReader();
            reader.onload = function (evt) {
              demo.setData(JSON.parse(evt.target.result));
            };
            reader.readAsText(event.target.files[0]);
          }
        },
      });

      // boot up the demo
      var demo = new Vue({
        el: "#demo",
        data: {
          treeData: {
            name: 'start',
            children: null,
            text: null
          }
        },
        methods: {
          makeFolder: function (item) {
            Vue.set(item, "children", []);
            this.addItem(item);
          },
          addItem: function (item) {
            item.children.push({
              name: "",
              text: "",
            });
          },
          removeChild: function (item, children) {
            children.splice(children.indexOf(item), 1);
          },
          getData: function (item) {
            const $el = document.createElement('a');
            $el.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(JSON.stringify(item)));
            $el.setAttribute('download', 'app_config.json');
            $el.style.display = 'none';
            document.body.appendChild($el);
            $el.click();
            document.body.removeChild($el);
          },
          setData: function (data) {
            this.$set(this.treeData, "children", data.children)
            this.$set(this.treeData, "text", data.text)
          }
        },
      });
    </script>
  </div>


  <div id="app"></div>
  <!-- App js -->
  
  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <script>
    window.addEventListener("beforeunload", function (e) {
      var confirmationMessage = "¿Confirma que desea salir?";
      (e || window.event).returnValue = confirmationMessage;
      return confirmationMessage;
    });
  </script>
</body>

</html>